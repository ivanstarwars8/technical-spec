HOMEWORK_PROMPT = """
Ты — опытный репетитор по {subject}.
Составь ПОЛНОЦЕННЫЙ РАБОЧИЙ ЛИСТ (worksheet) для ученика уровня {level} по теме "{topic}".

{problem_section}

СТРУКТУРА РАБОЧЕГО ЛИСТА (ОБЯЗАТЕЛЬНО ВКЛЮЧИ ВСЕ БЛОКИ):

## БЛОК 1: РАЗОГРЕВ (2-3 задания)
Простые задания чтобы вспомнить правило/формулу/теорию.
Форматы: заполни пропуск в правиле, закончи формулу, верно/неверно.

## БЛОК 2: БАЗОВАЯ ОТРАБОТКА (5-7 заданий)
Стандартные задания на отработку навыка.
Форматы: решение примеров, применение правила, вычисления.

## БЛОК 3: ЛОВУШКИ НА ТИПИЧНЫЕ ОШИБКИ (3-4 задания)
Задания где легко ошибиться если не понимаешь тему глубоко.
Специально включи случаи где ученики часто делают ошибки.

## БЛОК 4: НАЙДИ И ИСПРАВЬ ОШИБКУ (2-3 задания)
Дай решение с ошибкой — ученик должен найти и исправить.
Ошибки должны быть типичными для данной темы.

## БЛОК 5: ПРИМЕНЕНИЕ (2-3 задания)
Нестандартные задания, задачи из жизни, связь с другими темами.
Проверка что ученик ПОНИМАЕТ, а не просто запомнил.

ФОРМАТЫ ЗАДАНИЙ (используй РАЗНЫЕ, не повторяйся):
- Вставь пропущенное (слово/число/символ)
- Выбери правильный вариант (A/B/C/D)
- Найди и исправь ошибку
- Соотнеси (matching) — левый и правый столбец
- Трансформируй (преобразуй выражение/предложение)
- Верно/Неверно с объяснением почему
- Составь из частей/слов
- Реши и объясни ход решения
- Сравни и найди отличия

ТРЕБОВАНИЯ К КАЧЕСТВУ:
1. Минимум 15 заданий разных типов
2. Прогрессия от простого к сложному
3. Каждое задание имеет ОДИН правильный ответ
4. Решения должны объяснять ПОЧЕМУ ответ верный
5. Используй терминологию из школьных учебников
6. Для заданий с вариантами — варианты должны быть правдоподобными

ВАЖНО:
- Верни ТОЛЬКО валидный JSON без дополнительного текста
- Каждый блок должен быть представлен

Верни JSON в формате:
{{
  "worksheet_title": "Название рабочего листа",
  "blocks": [
    {{
      "block_name": "Разогрев",
      "block_description": "Вспоминаем основы",
      "tasks": [
        {{
          "number": 1,
          "type": "fill_blank",
          "text": "Текст задания",
          "solution": "Подробное решение",
          "answer": "Правильный ответ"
        }}
      ]
    }}
  ],
  "total_tasks": 15
}}
"""

# Секция проблемы для промпта
PROBLEM_SECTION_TEMPLATE = """
ПРОБЛЕМА УЧЕНИКА (ВАЖНО — задания должны решать эту проблему):
{problem}

Ученик уже много раз проходил эту тему, но продолжает ошибаться.
Твоя задача — создать задания которые:
1. Выявят корень проблемы (почему ошибается)
2. Дадут много практики именно на слабое место
3. Включат ловушки на эту конкретную ошибку
4. Помогут ПОНЯТЬ, а не просто запомнить
"""
